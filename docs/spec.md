# 仕様定義 - 蔵書管理アプリ

## 1. 画面仕様

### 1.1. 書籍登録ページ
- **UIコンポーネント:**
    - ISBN入力フィールド (テキスト)
    - 書籍情報取得ボタン
    - 書籍情報フォーム (自動入力 + 手動入力)
        - ISBN (読み取り専用)
        - タイトル (テキスト)
        - 著者 (テキスト)
        - 出版社 (テキスト)
        - ページ数 (数値)
        - サイズ (テキスト)
        - 購入日 (日付選択)
        - 定価 (数値)
        - 中古価格 (数値)
        - 本の状態 (選択式: 新品, 非常に良い, 良い, 可, 不可)
        - 要約/メモ (テキストエリア)
    - 保存ボタン
- **UXフロー:**
    1. ユーザーがISBNを入力し、「書籍情報取得」ボタンを押す。
    2. Backend API (`/api/lookup_book/{isbn}`) が呼ばれ、書籍情報がフォームに自動入力される。
    3. ユーザーが必要な情報を追加入力・修正する。
    4. 「保存」ボタンを押すと、Backend API (`POST /api/books/`) が呼ばれ、データが保存される。

### 1.2. 蔵書一覧ページ
- **UIコンポーネント:**
    - 検索バー
    - 書籍リスト (カード形式 or テーブル形式)
        - 各項目に表紙画像、タイトル、著者を表示。
- **機能:**
    - ページ読み込み時に `GET /api/books/` を呼び出し、全書籍情報を取得・表示する。
    - 検索バーに入力すると、リアルタイムでリストがフィルタリングされる。
    - 各書籍項目をクリックすると、書籍詳細ページに遷移する。

### 1.3. 蔵書一覧の各項目
- **UIコンポーネント:**
    - 登録されている主要情報を表示。
    - 「価格を更新」ボタン。
    - 「編集」ボタン、「削除」ボタン。
- **機能:**
    - 「価格を更新」ボタンで `GET /api/books/{isbn}/update_prices` を呼び出し、中古価格と定価を更新・表示する。
    - 「編集」ボタンで書籍登録ページと同様のフォームに遷移し、情報を更新できる (`PUT /api/books/{book_id}`)。
    - 「削除」ボタンで確認ダイアログの後、書籍を削除する (`DELETE /api/books/{book_id}`)。

## 2. API仕様 (Backend - FastAPI)

- `POST /api/books/`: 新しい書籍をデータベースに登録する。
- `GET /api/books/`: 登録されている全書籍のリストを取得する。
- `GET /api/books/{book_id}`: 指定されたIDの書籍詳細情報を取得する。
- `PUT /api/books/{book_id}`: 指定されたIDの書籍情報を更新する。
- `DELETE /api/books/{book_id}`: 指定されたIDの書籍を削除する。

### 外部連携API
- `GET /api/lookup_book/{isbn}`: ISBNをキーに外部API（例: openBD, Google Books API）から書籍情報を取得する。
- `GET /api/books/{isbn}/update_prices`: データベースに登録済みの書籍について、最新の価格情報をBook-Off Onlineから取得し、データベースを更新する。
- `GET /api/prices/{isbn}`: ISBNコードを元にBook-Off Onlineから価格情報を取得する（データベース登録不要）。